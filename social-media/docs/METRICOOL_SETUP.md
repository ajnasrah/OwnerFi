# Metricool Auto-Posting Setup

## Overview

Automatically post your viral videos to Instagram, TikTok, YouTube, and Facebook using Metricool's API after video generation is complete.

## How It Works

```
1. Video Generation Complete (Submagic webhook)
   â†“
2. System auto-posts to Metricool
   â†“
3. Metricool publishes to social platforms
   â€¢ Instagram Reels
   â€¢ TikTok
   â€¢ YouTube Shorts
   â€¢ Facebook Reels
```

---

## Setup Steps

### 1. Get Metricool API Credentials

1. **Sign up for Metricool:** https://metricool.com/
2. **Connect your social media accounts:**
   - Instagram
   - TikTok
   - YouTube
   - Facebook
3. **Get API access:**
   - Contact Metricool support to enable API access
   - Request your API key and User ID
   - Or check Settings > Integrations > API

### 2. Add Environment Variables

Add to your `.env.local`:

```bash
# Metricool API Configuration
METRICOOL_API_KEY=your_metricool_api_key_here
METRICOOL_USER_ID=your_user_id_here

# Auto-posting settings
METRICOOL_AUTO_POST=true  # Enable/disable auto-posting
METRICOOL_PLATFORMS=instagram,tiktok,youtube  # Comma-separated list
METRICOOL_SCHEDULE_DELAY=immediate  # immediate, 1hour, 2hours, 4hours, optimal

# Optional: Blog/Brand ID (if you have multiple)
METRICOOL_BLOG_ID=your_blog_id_here
```

### 3. Configure Platforms

Choose which platforms to post to:

```bash
# Post to all platforms
METRICOOL_PLATFORMS=instagram,tiktok,youtube,facebook

# Instagram and TikTok only
METRICOOL_PLATFORMS=instagram,tiktok

# YouTube Shorts only
METRICOOL_PLATFORMS=youtube
```

### 4. Choose Posting Schedule

```bash
# Post immediately when video is ready
METRICOOL_SCHEDULE_DELAY=immediate

# Delay by 1 hour
METRICOOL_SCHEDULE_DELAY=1hour

# Delay by 2 hours
METRICOOL_SCHEDULE_DELAY=2hours

# Delay by 4 hours
METRICOOL_SCHEDULE_DELAY=4hours

# Post at optimal time (7 PM)
METRICOOL_SCHEDULE_DELAY=optimal
```

---

## What Gets Posted

### Video Content
- **Video URL:** Final Submagic-enhanced video with captions and effects
- **Caption:** ChatGPT-generated caption with emojis
- **Title:** YouTube Shorts optimized title
- **Hashtags:** Automatically extracted from caption or generated by ChatGPT

### Example Post

```
Caption: "New Tesla at $25K?! This is a game changer! ðŸ¤¯âš¡"

Hashtags:
#Tesla
#ElectricCar
#EV
#CarNews
#TeslaModel2
#ElectricVehicle

Title: "Tesla's $25K Car Changes EVERYTHING! ðŸš—âš¡"
```

---

## Testing

### 1. Test Metricool Connection

```bash
# Make sure your server is running
npm run dev

# Generate a test video
node test_viral_video_webhook.js
```

### 2. Watch Server Logs

You should see:

```
ðŸ”” Submagic webhook received
âœ… Submagic video completed: https://...
ðŸŽ‰ WORKFLOW COMPLETE!

ðŸ“± Auto-posting to social media via Metricool...
ðŸ“¤ Posting to Metricool...
   Platforms: instagram, tiktok, youtube
   Caption: New Tesla at $25K?! This is a game changer...
âœ… Posted to Metricool!
   Post ID: post_12345
   Platforms: instagram, tiktok, youtube
```

### 3. Manual Test (API Call)

```bash
curl -X POST http://localhost:3000/api/metricool/test \
  -H "Content-Type: application/json" \
  -d '{
    "videoUrl": "https://your-video-url.mp4",
    "caption": "Check this out! ðŸ”¥",
    "title": "Amazing Video",
    "platforms": ["instagram", "tiktok"]
  }'
```

---

## Verification

### Check Metricool Dashboard

1. **Go to:** https://app.metricool.com/
2. **Navigate to:** Publisher > Scheduled Posts
3. **You should see:**
   - Your video scheduled/posted
   - Correct caption and hashtags
   - Selected platforms

---

## Platform-Specific Requirements

### Instagram Reels
- **Format:** Vertical (1080x1920)
- **Duration:** 15-90 seconds
- **File size:** Max 100 MB
- **Caption:** Max 2,200 characters
- **Hashtags:** Max 30

### TikTok
- **Format:** Vertical (1080x1920) or square
- **Duration:** 15-60 seconds (Shorts)
- **File size:** Max 287 MB
- **Caption:** Max 150 characters
- **Hashtags:** Recommended 3-5

### YouTube Shorts
- **Format:** Vertical (1080x1920)
- **Duration:** Max 60 seconds
- **File size:** Max 256 GB
- **Title:** Max 100 characters
- **Description:** Max 5,000 characters

### Facebook Reels
- **Format:** Vertical (1080x1920)
- **Duration:** 3-90 seconds
- **File size:** Max 4 GB
- **Caption:** Max 63,206 characters

---

## Troubleshooting

### Issue: "Metricool API credentials not configured"

**Fix:**
1. Add `METRICOOL_API_KEY` to `.env.local`
2. Add `METRICOOL_USER_ID` to `.env.local`
3. Restart your server: `npm run dev`

### Issue: "Failed to post to Metricool"

**Check:**
1. API credentials are correct
2. Metricool account has API access enabled
3. Social media accounts are connected in Metricool
4. Video URL is publicly accessible
5. Video meets platform requirements (format, size, duration)

### Issue: "Video not appearing on social media"

**Reasons:**
1. Post might be scheduled (check `METRICOOL_SCHEDULE_DELAY`)
2. Metricool is processing the post
3. Social platform API issues
4. Video doesn't meet platform requirements

**Check:**
- Metricool dashboard for post status
- Platform-specific error messages
- Video file format and size

---

## Manual Control

### Disable Auto-Posting

```bash
# In .env.local
METRICOOL_AUTO_POST=false
```

### Post Manually via API

```bash
curl -X POST http://localhost:3000/api/metricool/post \
  -H "Content-Type: application/json" \
  -d '{
    "workflowId": "abc-123-def",
    "platforms": ["instagram", "tiktok"]
  }'
```

---

## Cost Considerations

### Metricool Pricing
- **Free Plan:** Limited posts per month
- **Premium Plan:** ~$12-20/month for unlimited posts
- **Agency Plan:** ~$49+/month for multiple brands

### API Limits
- **Rate Limits:** Check Metricool documentation
- **Concurrent Posts:** Usually 1-5 at a time
- **Daily Limits:** Varies by plan

---

## Advanced Configuration

### Custom Caption Template

Edit `src/lib/metricool-api.ts` to customize caption format:

```typescript
function formatCaption(caption: string, hashtags?: string[]): string {
  // Add custom branding
  const branding = '\n\nðŸ“º Follow for more content!';

  // Add hashtags
  const hashtagStr = hashtags?.map(t => `#${t}`).join(' ') || '';

  return `${caption}${branding}\n\n${hashtagStr}`;
}
```

### Platform-Specific Captions

```typescript
const captions = {
  instagram: `${caption}\n\n${hashtags}\n\nLink in bio!`,
  tiktok: caption.substring(0, 150), // TikTok has shorter limit
  youtube: `${caption}\n\n${hashtags}\n\nSubscribe for more!`,
  facebook: caption
};
```

---

## Best Practices

### 1. Optimal Posting Times
- **Instagram:** 11 AM - 1 PM, 7 PM - 9 PM
- **TikTok:** 6 AM - 10 AM, 7 PM - 11 PM
- **YouTube:** 2 PM - 4 PM, 9 PM - 11 PM
- Use `METRICOOL_SCHEDULE_DELAY=optimal` for auto-scheduling

### 2. Caption Strategy
- Keep under 150 characters for TikTok
- Use 3-5 relevant hashtags
- Include call-to-action
- Add emojis for engagement

### 3. Video Optimization
- Use vertical format (1080x1920)
- Keep under 60 seconds
- Add captions (done by Submagic)
- Use trending audio (if applicable)

### 4. Hashtag Strategy
- Mix popular and niche hashtags
- Use 3-5 hashtags max
- Research trending hashtags in your niche
- Avoid banned or spammy hashtags

---

## Next Steps

1. âœ… Add Metricool credentials to `.env.local`
2. âœ… Choose platforms and schedule
3. âœ… Test with a video generation
4. âœ… Monitor Metricool dashboard
5. âœ… Track performance and optimize

**Ready to auto-post?** Just set `METRICOOL_AUTO_POST=true` and generate your next video! ðŸš€
